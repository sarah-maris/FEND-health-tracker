<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width, initial-scale=1"><title>Food Planner App</title><meta name=description content="App to track calorie consumption and plan healthy meals"><meta name=keywords content=nutrition,tracker,calories,healthy,foods><meta name=author content="Sarah Maris"><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,800,700,400italic|Open+Sans+Condensed:300" rel=stylesheet type=text/css><link rel=stylesheet href=assets/style-1361103782.min.css></head><body><section class=tracker-app><h1 class=app-header>Food Tracker</h1><div class=date-box><h3 class=date-header>Tracker Date</h3><div class=date-picker></div></div><div class=add-food-box><div><h3 class=search-header>Search</h3><input id=food-search class=food-box placeholder="What did you eat?" type=text> <img class=loader src=assets/images/loader.gif alt=loading></div><div class="food-table hidden"><div class=food-table-box><h5 class=data-header>Serving<br>Size</h5><p id=serving-size class=food-info></p></div><div class=food-table-box><h5 class=data-header>Calories<br>per Serving</h5><p id=serving-calories class=food-info></p></div><div class=food-table-box><h5 class=data-header><br>Servings</h5><p id=serving-box class=food-info><input name=servings id=num-servings class=food-input type=text value=1></p></div><div class=food-table-box><h5 class=data-header>Total<br>Calories</h5><p id=calories-eaten class=food-info></p></div><div class=food-table-box><input class=add-button type=submit value="Add Food" id=add-food></div></div><div class=search-results><div class="manual-option hidden"><h4 class=choose-manual>Not what you were looking for?<br>Enter your food item manually</h4><div id=enter-manual class=add-button>Enter Manually</div></div><ul class=results-list></ul></div></div><table><thead class=list-head><tr><th class=food-name>FOOD ITEM</th><th class=calories>SERVINGS</th><th class=calories>CALORIES</th><th class=remove>REMOVE</th></tr></thead><tbody class=food-list></tbody></table><div class=list-footer><a href=http://www.nutritionix.com/api><img src=assets/images/nutritionix-logo.png></a></div></section><section class=health-news><h3 class=news-header>Health News from<br>The New York Times</h3><ul class=news-items></ul><div class=list-footer><a href="http://developer.nytimes.com/"><img src=assets/images/nytimes-logo.png></a></div></section><script type=text/template id=date-template><input type="text" name="date" id="datepicker"></script><script type=text/template id=item-template><td> <p class="food-name"><%= name %></p> <p class="food-details">Serving size: <%= serveSize %> </td> <td class="servings"><%= servings%></td> <td class="calories"><%= calories%></td> <td class="remove"><span class="destroy">x</span></td></script><script type=text/template id=results-template><li class="results" id="option<%= id %>"> <p class="results-name"><%= name %></p> <p class="results-details">Serving size: <%= serveSize %> <span class="results-cals"><%= calories %> calories</span></p> </li></script><script type=text/template id=daily-cals-template><tr class="table-end"> <td colspan="2" class="calorie-count">TOTAL CALORIES CONSUMED TODAY</td> <td class="total-calories"><%= dailyCalories %></td> <td class="remove"></td> </tr></script><script type=text/template id=news-template><li class="news-item"> <a href="<%= newsURL %>' "target="_blank" class="news-headline"> <%= headline %> </a> <p class="news-date"><%= pubDate %></p> <p class="snippet"><%= paragraph %></p> </li></script><script src=js/lib-a7d1774c7b.min.js></script><script src=https://cdn.firebase.com/js/client/2.3.1/firebase.js></script><script src=https://cdn.firebase.com/libs/backbonefire/0.5.1/backbonefire.min.js></script><script>var app=app||{};app.Food=Backbone.Model.extend({defaults:{name:"",calories:100,dateEaten:"",servings:0,serveSize:"",order:0}});var app=app||{},FoodList=Backbone.Firebase.Collection.extend({model:app.Food,initialize:function(e,t){this.url=t.url},nextOrder:function(){return this.length?this.last().get("order")+1:1},comparator:function(e){return e.get("order")}}),app=app||{};app.FoodView=Backbone.View.extend({tagName:"tr",itemTemplate:_.template($("#item-template").html()),events:{"click .destroy":"clear"},initialize:function(){this.listenTo(this.model,"destroy",this.remove)},render:function(){return this.$el.html(this.itemTemplate(this.model.attributes)),this},clear:function(){app.appView.foodList.remove(this.model)}});var app=app||{};app.AppView=Backbone.View.extend({el:".tracker-app",dailyCalsTemplate:_.template($("#daily-cals-template").html()),resultsTemplate:_.template($("#results-template").html()),dateTemplate:_.template($("#date-template").html()),events:{"keyup #food-search":"searchFood","keyup #num-servings":"updateCals","keyup #serving-cals":"updateCals","click #add-food":"addFood","click #enter-manual":"enterManually"},initialize:function(){this.$datePicker=$(".date-picker"),this.$input=$("#food-search"),this.$manualOption=$(".manual-option"),this.$tableEnd=$(".table-end"),this.$list=$(".food-list"),this.$results=$(".results-list"),this.$foodTable=$(".food-table"),this.$numServings=$("#num-servings"),this.$serveSize=$("#serving-size"),this.$serveCals=$("#serving-calories"),this.$eatenCals=$("#calories-eaten"),this.$trackerHead=$(".list-head"),this.$trackerApp=$(".tracker-app"),this.appDate=moment(new Date).format("MM/DD/YYYY"),this.renderDate(),this.$("#datepicker").datepicker("setDate",this.appDate),this.showManual=!0,this.render(),this.listenTo(this.foodList,"all",this.render)},updateFoodList:function(){this.cleanDate=this.appDate.replace(/\//g,""),this.dateUrl="https://food-tracker-sam.firebaseio.com/"+this.cleanDate,this.foodList=new FoodList([],{url:this.dateUrl}),this.listenTo(this.foodList,"add",this.render),this.listenTo(this.foodList,"remove",this.render)},render:function(){var e=this;return this.updateFoodList(),this.foodList.length<1?this.$trackerHead.addClass("hidden"):this.$trackerHead.removeClass("hidden"),this.$list.html(""),this.foodList.each(function(t){e.showFood(t)}),this.showDailyCalories(),this},renderDate:function(e){var t=this;this.$datePicker.html(this.dateTemplate()),this.$("#datepicker").datepicker({showOn:"both",buttonImage:"assets/images/calendar.png",buttonImageOnly:!0,buttonText:"Select date",onSelect:function(e,s){t.updateView(e)}})},updateView:function(e){this.appDate=e,this.render()},searchFood:function(){var e=this.$input.val(),t=this,s={results:"0:15",fields:"item_name,brand_name,nf_calories,nf_serving_size_qty,nf_serving_size_unit",appId:"72e7d3f2",appKey:"be0b61430f161b795ac29ebebfada85a"};$(".loader").fadeIn(),$.ajax({type:"GET",url:"https://api.nutritionix.com/v1_1/search/"+e,dataType:"json",data:s}).done(function(e){if($(".loader").fadeOut(1e3),t.$results.html(""),t.$results.removeClass("hidden"),e.hits.length>0)t.showResults(e.hits);else{var s='<h4 class="no-results">NO RESULTS FOUND.<br>';s+="PLEASE ENTER FOOD ITEM MANUALLY</h4>",t.$results.prepend(s),t.enterManually()}}).fail(function(e){$(".loader").fadeOut(1e3);var s='<h4 class="no-results">NUTRITIONIX REQUEST FAILED<br>';s+="PLEASE ENTER FOOD ITEM MANUALLY</h4>",t.$results.html(s),t.enterManually()})},showResults:function(e){var t=this;this.showManual&&this.$manualOption.removeClass("hidden");for(var s=0;s<e.length;s++){var a=(e[s].fields,s),i={};i.name=e[s].fields.brand_name+" "+e[s].fields.item_name,i.cals=e[s].fields.nf_calories.toFixed(),i.serveSize=e[s].fields.nf_serving_size_qty,i.serveUnit=e[s].fields.nf_serving_size_unit,this.$results.append(this.resultsTemplate({name:i.name,calories:i.cals,id:a,serveUnit:i.serveUnit,serveSize:i.serveSize})),function(){var e=i;$("#option"+s).click(function(){t.showDetails(e),t.$manualOption.addClass("hidden"),t.showManual=!1})}()}},enterManually:function(){this.$foodTable.removeClass("hidden"),this.$manualOption.addClass("hidden"),this.showManual=!1;var e='<input name="serving-size" id="serving-size-input" ';e+='class="food-input size-input" type="text" >',this.$serveSize.html(e);var t='<input name="serving-calories" id="serving-cals"';t+='< class="food-input" type="text" value="">',this.$serveCals.html(t),this.$inputCals=$("#serving-cals")},showDetails:function(e){this.$foodTable.removeClass("hidden");var t=e.cals*this.$numServings.val();this.$input.val(e.name),this.$serveSize.html(e.serveSize+" "+e.serveUnit),this.$serveCals.html(e.cals),this.$eatenCals.html(t.toFixed())},updateCals:function(){var e=this.$serveCals.text()||this.$inputCals.val(),t=this.$numServings.val(),s=e*t;this.$eatenCals.html(s.toFixed())},foodAttributes:function(){var e;return e=$("#serving-size-input")?$("#serving-size-input").val():this.$serveSize.text(),{name:this.$input.val(),calories:parseInt(this.$eatenCals.text()),dateEaten:this.appDate,serveSize:e,servings:this.$numServings.val(),order:this.foodList.nextOrder()}},addFood:function(e){this.foodList.create(this.foodAttributes()),this.$input.val(""),this.$foodTable.addClass("hidden"),this.$results.addClass("hidden"),this.$input.attr("placeholder","What did you eat?").val(""),this.$numServings.val(1),this.$eatenCals.html(""),this.showManual=!0,this.render()},showFood:function(e){var t=new app.FoodView({model:e});this.$list.prepend(t.render().el)},showDailyCalories:function(){var e=this;this.$list.append(this.dailyCalsTemplate({dailyCalories:this.dailyCalories(e.foodList)}))},dailyCalories:function(e){return e.reduce(function(e,t){return e+t.get("calories")},0)}});var app=app||{};app.getNews=function(){var e=this;this.$newsItems=$(".news-items"),this.newsTemplate=_.template($("#news-template").html());var t="https://api.nytimes.com/svc/search/v2/articlesearch.json";t+="?"+$.param({"api-key":"f575d0bca4674b2ebaada99ac588d129",fq:'news_desk:("Health & Fitness") AND source:("The New York Times")',sort:"newest"}),$.ajax({url:t,method:"GET"}).done(function(t){for(var s=t.response.docs,a=6,i=0;i<a;i++)e.$newsItems.append(e.newsTemplate({headline:s[i].headline.main,paragraph:s[i].lead_paragraph||s[i].snippet,newsURL:s[i].web_url,pubDate:moment(s[i].pub_date).format("MMMM DD, YYYY")}))}).fail(function(t){e.$newsItems.text("New York Times Articles could not be loaded"),console.log("Bad AJAX request",t)})};var app=app||{},ENTER_KEY=13;$(function(){app.appView=new app.AppView,app.getNews()});</script></body></html>